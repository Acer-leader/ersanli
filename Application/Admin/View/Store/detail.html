<include file="Public:head"/>
<script type="text/javascript" src="__JS__/jquery.js"></script>
<style>
.imgnav{max-height: 30px;overflow: hidden;cursor: pointer;}
.imgwrapper{display: block;width: 78px;height: 78px;overflow: hidden;}
.imgwrapper img{display: block;width: 100%;padding: 0;margin: 0;border:0;}
.spanpd10{margin:10px;}
.wxtables.wxtables-sku.newtable{width: 40%;margin: 0;}
.img-list li{width: 60px;height:60px;}
.cst_h3 span{font-weight: normal;}
#imgdiv img{ max-width:190px; max-height:190px; display:none; margin:5px;}
.btnimage{width:80px; height:30px; background:white; border:1px solid #d9d9d9;cursor:pointer; position:relative; text-align:center; line-height:31px;}
.file{ position:absolute; top:0px; left:0; width:80px; height:30px; background:white; border:1px solid #d9d9d9;cursor:pointer; opacity:0}
#imgdiv2 img{ max-width:88px; max-height:88px; display:none; margin:5px;}
#xuanze2{ width:60px; height:30px; background:white; border:1px solid #d9d9d9; }
#xuanze2:hover{ background:#E6E6E6; }
.huase{display:none; width:86px; height:30px; margin:5px; text-indent:5px;}
.formitems .fi-name{width:300px !important;}
</style>
<script type="text/javascript" src="__LHG__/lhgcore.min.js"></script>
<script type="text/javascript" src="__LHG__/lhgcalendar.min.js"></script>
<script type="text/javascript" src="__JS__/datepicker/WdatePicker.js"></script>
<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=A607d61b18d43a1ff27abf4ac67da83c"></script>

<div class="container">
<div class="inner clearfix">
<include file="Public:left" />
<!-- end content-left -->

<div class="content-right fl">
<h1 class="content-right-title">查看详情</h1>
<form aciton="{:U('/Admin/Store/detail')}" method="post" id="setInformation">
<div class="panel-single panel-single-light mgt20 changeform">
        <h3 class="cst_h3 mgb20">基本信息</h3>
    <div>
        <div class="formitems">
            <label class="fi-name">门店logo：</label>
            <div class="form-controls pdt5 j-imglistPanel">
                <div class="pic1_showimage fl mgr10">
                    <img src="{$IMG_URL}{$info.storelogo}" height="80px">
                </div>
                <div class="btnimage fl">选择图片
                    <input type="file"  accept="image/jpg,image/jpeg,image/png" name="pic1" id="pic1" class="file" >
                </div>
                <div class="pic1_progress fl mgr15" style="display:none">
                    <img src="__IMAGES__/loadings.gif" width="30" />
                    <span class="pic1_percent">80%</span>
                </div>
                <span class="fi-help-text fl lh30 mgl10">建议大小（宽60高36）</span>
            </div>
        </div>
        <div class="formitems">
            <label class="fi-name">门店背景图：</label>
            <div class="form-controls pdt5 j-imglistPanel">
                <div class="pic1_showimage fl mgr10">
                    <img src="{$IMG_URL}{$info.shopbg}" height="80px">
                </div>
            </div>
        </div>
        <div class="formitems">
            <label class="fi-name"><span class="colorRed">*</span>店名：</label>
            <div class="form-controls">
                <input type="text" class="input" value="{$info.storename}" id='storename' name="storename" >
                <span class="lh30 mgl10"></span>
            </div>
        </div>
        <div class="formitems">
            <label class="fi-name">旗舰店：</label>
            <div class="form-controls">
                <if condition="$info['isflagship'] eq 0">
                <input type="radio" name='isflagship' value='0' checked/>否
                <input type="radio" name='isflagship' value='1'/>是
                <else/>
                <input type="radio" name='isflagship' value='0'/>否
                <input type="radio" name='isflagship' value='1' checked/>是
                </if>
                <span class="fi-help-text"></span>
            </div>
        </div>
        <notempty name="info['isflagship']">
        <div class="formitems">
            <label class="fi-name">店铺类型：</label>
            <div class="form-controls pdt5 j-imglistPanel">
                <div class="pic1_showimage fl mgr10">
                    <img src="{$info.storeicon}" height="20">
                </div>
            </div>
        </div>
        </notempty>
        <div class="formitems">
            <label class="fi-name">商店评分：</label>
            <div class="form-controls">{$info.score|default=0}分</div>
        </div>
        <div class="formitems">
            <label class="fi-name">余额：</label>
            <div class="form-controls">{$info.wallet|default=0.00}</div>
        </div>
        <div class="formitems">
            <label class="fi-name"><span class="colorRed"></span>负责人：</label>
            <div class="form-controls">
                <input type="text" class="input" value="{$info.name}" id="name" name="name">
                <span class="lh30 mgl10"></span>
            </div>
        </div>
        <div class="formitems">
            <label class="fi-name">电话：</label>
            <div class="form-controls">{$info.telephone}
                <input type="text" class="input" value="{$info.}" id="telephone" name="name">
                <span class="lh30 mgl10"></span>
            </div>
        </div>
        <div class="formitems">
            <label class="fi-name">性别：</label>
            <div class="form-controls">
                <select name="sex">
                    <option value="0">男</option>
                    <option value="1">女</option>
                    <option value="2">保密</option>
                </select>
            </div>
        </div>
        <div class="formitems">
            <label class="fi-name">地址：</label>
            <div class="form-controls">{$info.province}{$info.city}{$info.district}{$info.storeaddress}
                <input type="text" class="input" value="{$info.adress}" id="adress" name="name">
                <span class="lh30 mgl10"></span>
            </div>
        </div>
        
        <div class="formitems">
            <label class="fi-name">修改密码：</label>
            <div class="form-controls">
                <input type="password" class="input" placeholder='不填写则不修改,密码6~16位'  name="password"  id='password'>
                <span class="lh30 mgl10">不填写则不修改,密码6~16位</span>
            </div>
        </div>
        <div class="formitems">
            <label class="fi-name">状态：</label>
            <div class="form-controls">
                <if condition="$info['status'] eq 0">
                <input type="radio" name='status' value='0' checked/>启用
                <input type="radio" name='status' value='1'/>关闭
                <else/>
                <input type="radio" name='status' value='0'/>启用
                <input type="radio" name='status' value='1' checked/>关闭
                </if>
                <span class="fi-help-text"></span>
            </div>
        </div>
        <div class="formitems">
            <label class="fi-name">客服电话：</label>
            <div class="form-controls">{$info.tel}
                <input type="text" class="input" value="{$info.tel}" id="" name="name">
                <span class="lh30 mgl10"></span>
            </div>
        </div>
        <div class="formitems">
            <label class="fi-name">最后登录时间：</label>
            <div class="form-controls">{$info.last_login|date="Y-m-d H:i:s",###}</div>
        </div>
        <input type="hidden" name='id' value="{$info.id}">
    </div>

</div>
<!-- end 基本信息 -->
<!-- end 详情及其它 -->
<div class="panel-single panel-single-light mgt20 txtCenter">
    <a href="javascript:history.back(-1)" class="btn">返回</a>
    <input type="button" id="submit" class="btn btn-primary" value="保存">
</div>
</form>

</div>
<!-- end content-right -->
</div>
</div>
<!-- end container -->
<include file="Public:foot"/>
<script type="text/javascript" src="__JS__/jquery-form.js"></script>
<script>
$(function () {
    var percent = $('.pic1_percent');
    var progress = $('.pic1_progress');
    $("#pic1").wrap("<form id='pic11' action='{:U('/Admin/storeAddEditDelStatus/addImage')}' method='post' enctype='multipart/form-data'></form>");
    $("#pic1").change(function(){ //选择文件
        $("#pic11").ajaxSubmit({
            dataType:  'json', //数据格式为json
            beforeSend: function() { //开始上传
                progress.show(); //显示进度条
                var percentVal = '0%';
                percent.html(percentVal);
            },
            uploadProgress: function(event, position, total, percentComplete) {
                var percentVal = percentComplete + '%'; //获得进度
                percent.html(percentVal); //显示上传进度百分比
            },
            success: function(data) { //成功
                //console.log(data);
                var img = '<img src="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'"  width="100px" class="mgr10 mgt10 " onclick="delImg(this)"><input type="hidden" name="person_img" id="logo" value="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'">';
                //console.log(img);
                progress.hide();
                $('.pic1_showimage').html(img);
            },
            error:function(xhr){ //上传失败
                //console.log(xhr.status)
            }
        });
    });
});
$('#submit').click(function(){
    /*var areano      = $(".changeform select[name=areano]").val();
    if(areano < 1)
    {
        dialog.showTips('请选择区域','warn');return false;
    }*/
    var storename =$.trim($(".changeform input[name=storename]").val());
    if(storename.length<1)
    {
        dialog.showTips('请填写店铺名','warn');$("input[name=storename]").focus();return false;
    }else if(storename.length>100){
        dialog.showTips('请填写店铺名必须100字内','warn');$("input[name=storename]").focus();return false;
    }
    var name =$.trim($(".changeform input[name=name]").val());
    if(name.length>0){
        if(name.length>30){
            dialog.showTips(' 姓名必须30字内','warn');$("input[name=name]").focus();return false;
        }
    }
    //电话
    var phone =$.trim($(".changeform input[name=phone]").val());
    if(phone.length<12)
    {
        dialog.showTips('您的电话不合法','warn');$("input[name=phone]").focus();return false;
    }else if(phone.length>11){
        dialog.showTips('您的电话不合法','warn');$("input[name=storename]").focus();return false;
    }
    var name =$.trim($(".changeform input[name=name]").val());
    if(name.length>0){
        if(name.length>30){
            dialog.showTips(' 姓名必须30字内','warn');$("input[name=name]").focus();return false;
        }
    }


    var password =$.trim($(".changeform input[name=password]").val());
    if(password.length > 0){
        if(!password.match(/^[a-zA-Z0-9]{6,16}$/)){
            dialog.showTips('密码格式错误','warn');$("input[name=password]").focus();return false;
        }
    }
    var check_status      = $(".changeform select[name=check_status]").val();
    if(check_status < 1)
    {
        dialog.showTips('请选择处理状态','warn');return false;
    }
    var data = $("#setInformation").serialize();
    $.post("{:U('/Admin/Store/detail')}",data,function(g){
        if(g.status == 1){
            dialog.showTips(g.info,'',"{:U('/Admin/Store/index')}");return false;
        }else{
           dialog.showTips(g.info,'warn');return false;
        }
    },"json");
})
</script>



